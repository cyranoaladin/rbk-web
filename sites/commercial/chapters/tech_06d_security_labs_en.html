<div class="space-y-14 animate-in fade-in duration-700">

    <!-- Header -->
    <header class="relative p-8 rounded-2xl overflow-hidden border border-white/10 bg-slate-900/50">
        <div class="absolute -top-24 -right-24 w-64 h-64 bg-red-600/20 rounded-full blur-[100px]"></div>
        <div class="relative z-10">
            <div class="flex items-center gap-4 mb-4">
                <span
                    class="text-5xl font-black text-transparent bg-clip-text bg-gradient-to-r from-red-500 to-rose-600 font-mono">LABS</span>
                <div class="h-12 w-px bg-white/10"></div>
                <h1 class="text-3xl font-bold text-white tracking-tight">Security Audit<span
                        class="block text-lg font-normal text-slate-400 mt-1">Find, Explain, Fix</span></h1>
            </div>
            <p class="text-sm text-slate-400 max-w-3xl leading-relaxed">
                Code is liability. This section is an intensive audit workshop: we start with vulnerable snippets,
                explain the threat model, and patch them. Each lab exists in both <strong>Anchor</strong> and
                <strong>Native</strong> versions.
            </p>
        </div>
    </header>

    <!-- Objectives -->
    <div class="grid md:grid-cols-3 gap-6">
        <div class="md:col-span-1 p-6 rounded-xl border border-red-500/20 bg-red-500/[0.02] h-full">
            <h3 class="flex items-center gap-2 text-red-500 font-bold mb-4">
                <i data-lucide="crosshair" class="w-4 h-4"></i>
                Mission
            </h3>
            <ul class="space-y-3">
                <li class="flex gap-3 text-xs text-slate-400">
                    <i data-lucide="check" class="w-4 h-4 text-red-500 shrink-0"></i>
                    <span>Identify common vulns (Owner, Signer, Seeds).</span>
                </li>
                <li class="flex gap-3 text-xs text-slate-400">
                    <i data-lucide="check" class="w-4 h-4 text-red-500 shrink-0"></i>
                    <span>Write robust fixes.</span>
                </li>
                <li class="flex gap-3 text-xs text-slate-400">
                    <i data-lucide="check" class="w-4 h-4 text-red-500 shrink-0"></i>
                    <span>Produce clear audit notes.</span>
                </li>
            </ul>
        </div>

        <div class="md:col-span-2 p-6 rounded-xl border border-white/5 bg-slate-800/50 h-full">
            <h3 class="flex items-center gap-2 text-white font-bold mb-4">
                <i data-lucide="file-code" class="w-4 h-4 text-blue-400"></i>
                Lab Format
            </h3>
            <div class="grid grid-cols-2 md:grid-cols-4 gap-4 text-center">
                <div class="p-3 bg-black/30 rounded border border-white/5">
                    <div class="text-red-400 font-bold mb-1">1. Snippet</div>
                    <div class="text-[10px] text-slate-500">The vulnerable code</div>
                </div>
                <div class="p-3 bg-black/30 rounded border border-white/5">
                    <div class="text-yellow-400 font-bold mb-1">2. Threat</div>
                    <div class="text-[10px] text-slate-500">Impact & Attack Vector</div>
                </div>
                <div class="p-3 bg-black/30 rounded border border-white/5">
                    <div class="text-green-400 font-bold mb-1">3. Fix</div>
                    <div class="text-[10px] text-slate-500">The patch (Native/Anchor)</div>
                </div>
                <div class="p-3 bg-black/30 rounded border border-white/5">
                    <div class="text-blue-400 font-bold mb-1">4. Test</div>
                    <div class="text-[10px] text-slate-500">Hack reproduction</div>
                </div>
            </div>
        </div>
    </div>

    <!-- Lab 1 Highlight -->
    <section class="group p-1 rounded-2xl bg-gradient-to-b from-white/10 to-transparent">
        <div class="bg-[#1e1e1e] rounded-xl p-8 border border-white/5">
            <div class="flex items-center gap-4 mb-6">
                <div
                    class="w-10 h-10 rounded-lg bg-red-500/10 flex items-center justify-center text-red-500 font-bold border border-red-500/20">
                    01</div>
                <div>
                    <h2 class="text-xl font-bold text-white">Lab 1: Missing Owner Check</h2>
                    <p class="text-xs text-red-400">Critical Severity</p>
                </div>
            </div>

            <div class="grid md:grid-cols-2 gap-8">
                <!-- Vulnerable -->
                <div class="space-y-2">
                    <div
                        class="flex items-center justify-between text-xs text-red-400 font-bold uppercase tracking-wider">
                        <span>Vulnerable Code</span>
                        <i data-lucide="shield-alert" class="w-4 h-4"></i>
                    </div>
                    <div
                        class="bg-black/50 p-4 rounded-xl border border-red-900/30 font-mono text-[10px] text-slate-400 relative overflow-hidden">
                        <div class="absolute top-0 right-0 p-2 bg-red-900/20 text-red-500 text-[8px] font-bold">UNSAFE
                        </div>
                        <span class="text-purple-400">fn</span> <span class="text-blue-400">process</span>(accounts:
                        /* implementation details */) {
                        <br>&nbsp;&nbsp;<span class="text-slate-500">// ⚠️ Accepts any account!</span>
                        <br>&nbsp;&nbsp;<span class="text-purple-400">let</span> state = accounts.state;
                        <br>&nbsp;&nbsp;<span class="text-slate-500">// Attacker injects a fake account with fake
                            data</span>
                        <br>&nbsp;&nbsp;<span class="text-purple-400">let</span> data = state.try_borrow_data()?;
                        <br>}
                    </div>
                </div>

                <!-- Fixed -->
                <div class="space-y-2">
                    <div
                        class="flex items-center justify-between text-xs text-green-400 font-bold uppercase tracking-wider">
                        <span>Patched Code</span>
                        <i data-lucide="shield-check" class="w-4 h-4"></i>
                    </div>
                    <div
                        class="bg-black/50 p-4 rounded-xl border border-green-900/30 font-mono text-[10px] text-slate-400 relative overflow-hidden">
                        <div class="absolute top-0 right-0 p-2 bg-green-900/20 text-green-500 text-[8px] font-bold">SAFE
                        </div>
                        <span class="text-slate-500">// Native</span>
                        <br><span class="text-purple-400">if</span> state.owner != program_id {
                        <br>&nbsp;&nbsp;<span class="text-purple-400">return</span> <span
                            class="text-red-400">Err</span>(Error::IncorrectProgramId);
                        <br>}
                        <br><br>
                        <span class="text-slate-500">// Anchor</span>
                        <br><span class="text-purple-400">#[account(owner = crate::ID)]</span>
                        <br><span class="text-blue-400">pub</span> <span class="text-white">state</span>: <span
                            class="text-yellow-400">Account</span>&lt;'info, State&gt;,
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Lab Grid (2-10) -->
    <section class="grid md:grid-cols-2 gap-4">

        <!-- Lab 2 -->
        <div class="p-4 bg-white/5 border border-white/5 rounded-xl hover:border-red-500/30 transition-colors group">
            <div class="flex justify-between items-start mb-2">
                <h3 class="text-white font-bold group-hover:text-red-400 transition-colors">Lab 2: Missing Signer</h3>
                <span class="text-[10px] bg-red-500/20 text-red-500 px-2 py-0.5 rounded">Auth Bypass</span>
            </div>
            <p class="text-xs text-slate-400">A critical instruction (Withdraw) does not require the authority to have
                signed the transaction.</p>
        </div>

        <!-- Lab 3 -->
        <div class="p-4 bg-white/5 border border-white/5 rounded-xl hover:border-red-500/30 transition-colors group">
            <div class="flex justify-between items-start mb-2">
                <h3 class="text-white font-bold group-hover:text-red-400 transition-colors">Lab 3: Bad PDA Seeds</h3>
                <span class="text-[10px] bg-orange-500/20 text-orange-500 px-2 py-0.5 rounded">Spoofing</span>
            </div>
            <p class="text-xs text-slate-400">Generic or unstable seeds allowing collisions or Vault substitution.</p>
        </div>

        <!-- Lab 4 -->
        <div class="p-4 bg-white/5 border border-white/5 rounded-xl hover:border-red-500/30 transition-colors group">
            <div class="flex justify-between items-start mb-2">
                <h3 class="text-white font-bold group-hover:text-red-400 transition-colors">Lab 4: Excess Writable</h3>
                <span class="text-[10px] bg-yellow-500/20 text-yellow-500 px-2 py-0.5 rounded">Risk</span>
            </div>
            <p class="text-xs text-slate-400">Requesting `mut` without reason increases attack surface (parallelism,
                logic bugs).</p>
        </div>

        <!-- Lab 5 -->
        <div class="p-4 bg-white/5 border border-white/5 rounded-xl hover:border-red-500/30 transition-colors group">
            <div class="flex justify-between items-start mb-2">
                <h3 class="text-white font-bold group-hover:text-red-400 transition-colors">Lab 5: Token Authority Bad
                    Check</h3>
                <span class="text-[10px] bg-red-500/20 text-red-500 px-2 py-0.5 rounded">Theft</span>
            </div>
            <p class="text-xs text-slate-400">Confusion between TokenAccount Owner and the expected Authority
                (Delegate).</p>
        </div>

        <!-- Lab 6 -->
        <div class="p-4 bg-white/5 border border-white/5 rounded-xl hover:border-red-500/30 transition-colors group">
            <div class="flex justify-between items-start mb-2">
                <h3 class="text-white font-bold group-hover:text-red-400 transition-colors">Lab 6: Fake CPI Program</h3>
                <span class="text-[10px] bg-red-500/20 text-red-500 px-2 py-0.5 rounded">Phishing</span>
            </div>
            <p class="text-xs text-slate-400">Instruction accepts an arbitrary `token_program`. Attacker passes a
                malicious program.</p>
        </div>

        <!-- Lab 7 -->
        <div class="p-4 bg-white/5 border border-white/5 rounded-xl hover:border-red-500/30 transition-colors group">
            <div class="flex justify-between items-start mb-2">
                <h3 class="text-white font-bold group-hover:text-red-400 transition-colors">Lab 7: Bad Invariants</h3>
                <span class="text-[10px] bg-orange-500/20 text-orange-500 px-2 py-0.5 rounded">Logic Error</span>
            </div>
            <p class="text-xs text-slate-400">Missing state checks (bal > 0, invalid state transition). Mathematical
                incoherence.</p>
        </div>

        <!-- Lab 8 -->
        <div class="p-4 bg-white/5 border border-white/5 rounded-xl hover:border-red-500/30 transition-colors group">
            <div class="flex justify-between items-start mb-2">
                <h3 class="text-white font-bold group-hover:text-red-400 transition-colors">Lab 8: Unsafe Close</h3>
                <span class="text-[10px] bg-red-500/20 text-red-500 px-2 py-0.5 rounded">Drain</span>
            </div>
            <p class="text-xs text-slate-400">Closing account sending Lamports to an unverified destination.</p>
        </div>

        <!-- Lab 9 -->
        <div class="p-4 bg-white/5 border border-white/5 rounded-xl hover:border-red-500/30 transition-colors group">
            <div class="flex justify-between items-start mb-2">
                <h3 class="text-white font-bold group-hover:text-red-400 transition-colors">Lab 9: Reentrancy / Ordering
                </h3>
                <span class="text-[10px] bg-orange-500/20 text-orange-500 px-2 py-0.5 rounded">Logic</span>
            </div>
            <p class="text-xs text-slate-400">State mutation AFTER a CPI. Always follow: Check -> Effect -> Interact.
            </p>
        </div>

        <!-- Lab 10 -->
        <div class="p-4 bg-white/5 border border-white/5 rounded-xl hover:border-red-500/30 transition-colors group">
            <div class="flex justify-between items-start mb-2">
                <h3 class="text-white font-bold group-hover:text-red-400 transition-colors">Lab 10: Silent Failures</h3>
                <span class="text-[10px] bg-yellow-500/20 text-yellow-500 px-2 py-0.5 rounded">Audit</span>
            </div>
            <p class="text-xs text-slate-400">Hidden errors or generic 0x1 codes. Missing negative tests.</p>
        </div>

    </section>

    <!-- Deliverables -->
    <section class="space-y-6">
        <div class="flex items-center gap-3 border-b border-white/10 pb-4">
            <div class="p-2 rounded-lg bg-green-500/10 text-green-500 border border-green-500/20">
                <i data-lucide="check-circle-2" class="w-5 h-5"></i>
            </div>
            <h2 class="text-xl font-bold text-white">Deliverables (Proofs)</h2>
        </div>

        <div class="grid md:grid-cols-2 gap-4">
            <div class="p-4 bg-slate-800/50 rounded-xl border border-slate-700 flex gap-4 items-center">
                <i data-lucide="file-warning" class="w-8 h-8 text-red-400"></i>
                <div>
                    <h4 class="text-sm font-bold text-white">10 Audit Notes</h4>
                    <p class="text-xs text-slate-400">For each Lab: Bug / Impact / Fix / Proof.</p>
                </div>
            </div>
            <div class="p-4 bg-slate-800/50 rounded-xl border border-slate-700 flex gap-4 items-center">
                <i data-lucide="shield-check" class="w-8 h-8 text-green-400"></i>
                <div>
                    <h4 class="text-sm font-bold text-white">"Audit-Ready" Checklist</h4>
                    <p class="text-xs text-slate-400">The final validation grid for any project.</p>
                </div>
            </div>
        </div>
    </section>
</div>
<div class="space-y-14 animate-in fade-in duration-700">

    <!-- Header -->
    <header class="relative p-8 rounded-2xl overflow-hidden border border-white/10 bg-slate-900/50">
        <div class="absolute -top-24 -right-24 w-64 h-64 bg-[#9945FF]/20 rounded-full blur-[100px]"></div>
        <div class="relative z-10">
            <div class="flex items-center gap-4 mb-4">
                <span
                    class="text-5xl font-black text-transparent bg-clip-text bg-gradient-to-r from-[#9945FF] to-fuchsia-400 font-mono">N3</span>
                <div class="h-12 w-px bg-white/10"></div>
                <h1 class="text-3xl font-bold text-white tracking-tight">
                    DeFi avancée : CPI, Tokens, AMM (capstone)
                    <span class="block text-lg font-normal text-slate-400 mt-1">Anchor Capstone → (préparation Native &
                        Security)</span>
                </h1>
            </div>

            <p class="text-sm text-slate-400 max-w-3xl leading-relaxed">
                N3 vise à construire une compréhension “produit” des primitives DeFi sur Solana : transferts via CPI,
                états cohérents, contraintes, tests négatifs, et design d’un mini-protocole.
                L’objectif est de livrer un capstone utilisable, documenté et testable — pas de réciter des buzzwords.
            </p>

            <div class="mt-6 grid grid-cols-1 md:grid-cols-3 gap-3">
                <div class="p-4 rounded-xl border border-white/10 bg-slate-950/40">
                    <div class="flex items-center gap-2 text-xs font-bold text-white">
                        <i data-lucide="timer" class="w-4 h-4 text-[#9945FF]"></i>
                        Durée indicative
                    </div>
                    <p class="text-xs text-slate-400 mt-2">12–20h selon l’aisance Rust/Anchor, 70% pratique + tests.</p>
                </div>

                <div class="p-4 rounded-xl border border-white/10 bg-slate-950/40">
                    <div class="flex items-center gap-2 text-xs font-bold text-white">
                        <i data-lucide="package-check" class="w-4 h-4 text-[#9945FF]"></i>
                        Livrables
                    </div>
                    <p class="text-xs text-slate-400 mt-2">Capstone AMM-like (mini), tests négatifs, README, audit
                        notes.</p>
                </div>

                <div class="p-4 rounded-xl border border-white/10 bg-slate-950/40">
                    <div class="flex items-center gap-2 text-xs font-bold text-white">
                        <i data-lucide="shield-check" class="w-4 h-4 text-[#9945FF]"></i>
                        Critère de réussite
                    </div>
                    <p class="text-xs text-slate-400 mt-2">CPI maîtrisées + invariants + scénarios d’échec reproduits
                        par tests.</p>
                </div>
            </div>
        </div>
    </header>

    <!-- Section 1 -->
    <section class="group p-1 rounded-2xl bg-gradient-to-b from-white/10 to-transparent">
        <div class="rounded-2xl border border-white/10 bg-slate-950/50 p-6 md:p-8 space-y-6">
            <div class="flex items-center justify-between gap-4 flex-wrap">
                <div>
                    <h2 class="text-2xl font-bold text-white">1) CPI & Tokens — la plomberie DeFi</h2>
                    <p class="text-sm text-slate-400 mt-1">
                        Comprendre qu’un transfert SPL, une mint, un burn, un freeze… sont des <strong>instructions
                            CPI</strong>.
                    </p>
                </div>

                <span
                    class="text-[10px] uppercase font-bold tracking-widest text-[#9945FF]/90 bg-[#9945FF]/10 px-3 py-1 rounded-full border border-[#9945FF]/20">
                    Core building block
                </span>
            </div>

            <div class="grid grid-cols-1 lg:grid-cols-2 gap-4">
                <div class="p-5 rounded-xl border border-white/10 bg-slate-900/40 space-y-3">
                    <h3 class="text-sm font-bold text-white flex items-center gap-2">
                        <i data-lucide="repeat" class="w-4 h-4 text-slate-400"></i>
                        CPI : modèle mental
                    </h3>
                    <ul class="space-y-2 text-xs text-slate-400">
                        <li>On appelle un autre programme (Token Program, System Program…)</li>
                        <li>On passe les <strong>accounts requis</strong> explicitement</li>
                        <li>Les autorités doivent être correctes (signer, PDA signer, delegates)</li>
                        <li>Les erreurs doivent être reproductibles en tests (negative tests)</li>
                    </ul>
                </div>

                <div class="p-5 rounded-xl border border-white/10 bg-slate-900/40 space-y-3">
                    <h3 class="text-sm font-bold text-white flex items-center gap-2">
                        <i data-lucide="coins" class="w-4 h-4 text-slate-400"></i>
                        Tokens : ce qu’on veut réellement maîtriser
                    </h3>
                    <ul class="space-y-2 text-xs text-slate-400">
                        <li>Mint / Token Accounts / Associated Token Accounts (ATA)</li>
                        <li>Authorities : mint authority, freeze authority, owner</li>
                        <li>Décimales & unités (u64) + overflow/underflow</li>
                        <li>Token-2022 : extensions (à venir dans le module tokens)</li>
                    </ul>
                </div>
            </div>

            <div class="p-5 rounded-xl border border-white/10 bg-slate-900/40">
                <h3 class="text-sm font-bold text-white flex items-center gap-2 mb-3">
                    <i data-lucide="flask-conical" class="w-4 h-4 text-slate-400"></i>
                    Tests attendus (minimum)
                </h3>
                <ul class="space-y-2 text-xs text-slate-400">
                    <li>Transfert : happy path</li>
                    <li>Transfert : mauvais owner / mauvais signer → erreur attendue</li>
                    <li>Transfert : solde insuffisant → erreur attendue</li>
                    <li>Constraints : comptes incomplets/incorrects → erreur attendue</li>
                </ul>
            </div>
        </div>
    </section>

    <!-- Section 1 -->
    <section class="group p-1 rounded-2xl bg-gradient-to-b from-white/10 to-transparent">
        <div class="rounded-2xl border border-white/10 bg-slate-950/50 p-6 md:p-8 space-y-6">
            <div class="flex items-center justify-between gap-4 flex-wrap">
                <div>
                    <h2 class="text-2xl font-bold text-white">1) CPI & Tokens — la plomberie DeFi</h2>
                    <p class="text-sm text-slate-400 mt-1">
                        Comprendre qu’un transfert SPL, une mint, un burn, un freezeetc. sont des <strong>instructions
                            CPI</strong>.
                    </p>
                </div>

                <span
                    class="text-[10px] uppercase font-bold tracking-widest text-[#9945FF]/90 bg-[#9945FF]/10 px-3 py-1 rounded-full border border-[#9945FF]/20">
                    Core building block
                </span>
            </div>

            <div class="grid grid-cols-1 lg:grid-cols-2 gap-4">
                <div class="p-5 rounded-xl border border-white/10 bg-slate-900/40 space-y-3">
                    <h3 class="text-sm font-bold text-white flex items-center gap-2">
                        <i data-lucide="repeat" class="w-4 h-4 text-slate-400"></i>
                        CPI : modèle mental
                    </h3>
                    <div class="my-2 p-2 bg-slate-800 rounded border border-slate-700">
                        <pre class="mermaid text-[10px] bg-transparent">
flowchart TD
    User([User]) -->|Sign| ProgA[MyProgram]
    ProgA -->|"invoke_signed(seeds)"| TokenProg
    TokenProg -->|Verify| PDA[(Vault PDA)]
                        </pre>
                    </div>
                    <ul class="space-y-2 text-xs text-slate-400">
                        <li><strong>invoke</strong>: transmet la signature du Payer.</li>
                        <li><strong>invoke_signed</strong>: le programme signe pour ses PDAs (seeds + bump).</li>
                        <li>Erreur classique: <em>Signer privilege escalated</em> (donner des droits à un programme
                            malveillant).</li>
                    </ul>
                </div>

                <div class="p-5 rounded-xl border border-white/10 bg-slate-900/40 space-y-3">
                    <h3 class="text-sm font-bold text-white flex items-center gap-2">
                        <i data-lucide="coins" class="w-4 h-4 text-slate-400"></i>
                        Token-2022 : le futur standard
                    </h3>
                    <ul class="space-y-2 text-xs text-slate-400">
                        <li><strong class="text-indigo-400">Transfer Fees</strong> : Taxe prélevée automatiquement
                            (Royalties enforcement).</li>
                        <li><strong class="text-indigo-400">Deep Hooks</strong> : Logique custom par transaction
                            (Whitelisting dynamique).</li>
                        <li><strong class="text-indigo-400">Metadata Pointer</strong> : Stockage on-chain léger sans
                            Metaplex (pour les cas simples).</li>
                    </ul>
                    <div class="mt-2 p-2 bg-indigo-900/20 rounded border border-indigo-500/20">
                        <div class="text-[10px] font-bold text-indigo-300">Activité Flash : Choix d'extension</div>
                        <p class="text-[10px] text-slate-500">Pour un Stablecoin Euro ? &rarr; <em>Freeze Authority</em>
                            + <em>Interest Bearing</em>.</p>
                    </div>
                </div>
            </div>

            <div class="p-5 rounded-xl border border-white/10 bg-slate-900/40">
                <h3 class="text-sm font-bold text-white flex items-center gap-2 mb-3">
                    <i data-lucide="flask-conical" class="w-4 h-4 text-slate-400"></i>
                    Tests attendus (minimum)
                </h3>
                <ul class="space-y-2 text-xs text-slate-400">
                    <li>Transfert : happy path</li>
                    <li>Transfert : mauvais owner / mauvais signer &rarr; erreur attendue</li>
                    <li>Transfert : solde insuffisant &rarr; erreur attendue</li>
                    <li>Constraints : comptes incomplets/incorrects &rarr; erreur attendue</li>
                </ul>
            </div>
        </div>
    </section>

    <span
        class="text-[10px] uppercase font-bold tracking-widest text-fuchsia-300 bg-fuchsia-500/10 px-3 py-1 rounded-full border border-fuchsia-400/20">
        Capstone
    </span>
</div>

<div class="grid grid-cols-1 lg:grid-cols-3 gap-4">
    <div class="p-5 rounded-xl border border-white/10 bg-slate-900/40 space-y-3">
        <h3 class="text-sm font-bold text-white flex items-center gap-2">
            <i data-lucide="database" class="w-4 h-4 text-slate-400"></i>
            État (accounts)
        </h3>
        <ul class="space-y-2 text-xs text-slate-400">
            <li>PDA PoolState (seeds/bump)</li>
            <li>Vault A / Vault B (token accounts contrôlés)</li>
            <li>Config : fees, authority, paramètres</li>
            <li>Option : LP mint (si extension)</li>
        </ul>
    </div>

    <div class="p-5 rounded-xl border border-white/10 bg-slate-900/40 space-y-3">
        <h3 class="text-sm font-bold text-white flex items-center gap-2">
            <i data-lucide="scale" class="w-4 h-4 text-slate-400"></i>
            Invariants (à expliciter)
        </h3>
        <ul class="space-y-2 text-xs text-slate-400">
            <li>Vaults cohérents vs état</li>
            <li>Les fees ne cassent pas le modèle</li>
            <li>Swap : pas de résultat “gratuit”</li>
            <li>Overflow/underflow impossible</li>
        </ul>
    </div>

    <div class="p-5 rounded-xl border border-white/10 bg-slate-900/40 space-y-3">
        <h3 class="text-sm font-bold text-white flex items-center gap-2">
            <i data-lucide="alert-triangle" class="w-4 h-4 text-slate-400"></i>
            Edge cases (obligatoires)
        </h3>
        <ul class="space-y-2 text-xs text-slate-400">
            <li>Swap avec zéro / dust</li>
            <li>Slippage (min_out)</li>
            <li>Comptes ATA manquants</li>
            <li>Authority incorrecte</li>
        </ul>
    </div>
</div>

<div class="p-5 rounded-xl border border-white/10 bg-slate-900/40">
    <h3 class="text-sm font-bold text-white mb-3">Plan de capstone (pragmatique)</h3>
    <ol class="list-decimal pl-5 space-y-2 text-xs text-slate-400">
        <li>Init pool : créer PoolState PDA + vaults A/B</li>
        <li>Deposit : dépôt A/B vers vaults (CPI token)</li>
        <li>Swap : calcul + transfert (CPI token), respecter min_out</li>
        <li>Withdraw : retrait contrôlé (option : share/LP)</li>
        <li>Tests : happy + négatifs + invariants</li>
    </ol>
</div>
</div>
</section>

<!-- Section 3 -->
<section class="space-y-6">
    <div class="flex items-center gap-3">
        <div class="p-2 rounded-lg bg-red-500/10 border border-red-500/20">
            <i data-lucide="shield-alert" class="w-5 h-5 text-red-400"></i>
        </div>
        <h2 class="text-2xl font-bold text-white">3) Pré-sécurité : ce qu’on doit déjà traquer</h2>
    </div>

    <div class="grid grid-cols-1 lg:grid-cols-3 gap-4">
        <div class="p-6 rounded-2xl border border-white/10 bg-slate-950/40 space-y-3">
            <div class="text-xs font-bold text-white flex items-center gap-2">
                <i data-lucide="key-round" class="w-4 h-4 text-slate-400"></i>
                Authority & ownership
            </div>
            <ul class="space-y-2 text-xs text-slate-400">
                <li>Une action “critique” doit vérifier l’autorité</li>
                <li>On ne fait pas confiance au client</li>
                <li>has_one/constraint doivent être cohérents</li>
            </ul>
        </div>

        <div class="p-6 rounded-2xl border border-white/10 bg-slate-950/40 space-y-3">
            <div class="text-xs font-bold text-white flex items-center gap-2">
                <i data-lucide="infinity" class="w-4 h-4 text-slate-400"></i>
                Math & overflow
            </div>
            <ul class="space-y-2 text-xs text-slate-400">
                <li>checked_add / checked_sub partout</li>
                <li>Décimales : conversions explicites</li>
                <li>Min/Max, slippage, rounding</li>
            </ul>
        </div>

        <div class="p-6 rounded-2xl border border-white/10 bg-slate-950/40 space-y-3">
            <div class="text-xs font-bold text-white flex items-center gap-2">
                <i data-lucide="bug" class="w-4 h-4 text-slate-400"></i>
                Tests négatifs
            </div>
            <ul class="space-y-2 text-xs text-slate-400">
                <li>On doit pouvoir reproduire la faille</li>
                <li>Un test = scénario + expectation</li>
                <li>Les erreurs doivent être explicites</li>
            </ul>
        </div>
    </div>

    <div class="p-6 rounded-2xl border border-red-500/20 bg-red-500/5 space-y-4">
        <div class="flex items-center gap-3">
            <div class="p-2 rounded-lg bg-red-500/10 border border-red-500/20">
                <i data-lucide="file-search" class="w-5 h-5 text-red-400"></i>
            </div>
            <div>
                <h3 class="text-lg font-bold text-white">Passage recommandé</h3>
                <p class="text-xs text-slate-400">Après N3, on enchaîne sur des Security Labs (Anchor + Native).</p>
            </div>
        </div>

    </div>

    <div class="p-6 rounded-2xl border border-white/10 bg-slate-950/40">
        <div class="text-xs uppercase tracking-widest font-bold text-slate-500">Livrable final</div>
        <div class="text-lg font-bold text-white mt-1">Audit Report V1.0</div>
        <div class="text-xs text-slate-500 mt-1">Le sésame pour entrer dans l'industrie.</div>
    </div>
</section>

</div>